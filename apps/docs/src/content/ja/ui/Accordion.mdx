---
title: 'Accordion'
description: '@lism-css/ui で提供する Accordion コンポーネントについて解説します。'
---

import { Divider, Stack, HTML, Center, Flex, Icon, Dummy } from 'lism-css/astro';
import { Accordion } from '@lism-css/ui/astro';
import { Minus, Plus, X, Question, CaretDoubleDown, EyeClosed, Eyes } from "@phosphor-icons/react";

アコーディオン要素を作成できるUIコンポーネントです。


<Preview>
	<PreviewTitle>Preview</PreviewTitle>
	<PreviewArea p='20'>
		<Stack bd-y>
			<Accordion.Root>
				<Accordion.Header p='15' bgc='base-2' hov="neutral">
					<Accordion.Label>Accordion Example</Accordion.Label>
					<Accordion.Icon />
				</Accordion.Header>
				<Accordion.Body p='15'>
					<Dummy length='l' />
				</Accordion.Body>
			</Accordion.Root>
			<Accordion.Root bd-t>
				<Accordion.Header p='15' bgc='base-2' hov="neutral">
					<Accordion.Label>Accordion Example</Accordion.Label>
					<Accordion.Icon />
				</Accordion.Header>
				<Accordion.Body p='15'>
					<Dummy length='l' />
				</Accordion.Body>
			</Accordion.Root>
		</Stack>
	</PreviewArea>
	<PreviewCode slot='tab' label='JSX'>
		```jsx
		<Accordion.Root p='15'>
			<Accordion.Header>
				<Accordion.Label>Accordion Example</Accordion.Label>
				<Accordion.Icon />
			</Accordion.Header>
			<Accordion.Body my-s='15'>
				<Dummy length='l' />
			</Accordion.Body>
		</Accordion.Root>
		```
	</PreviewCode>
	<PreviewCode slot='tab' label='HTML'>
```html
<details class="d--accordion -p:15">
	<summary class="d--accordion_header">
		<span class="d--accordion_label">Accordion Label</span>
		<span class="d--accordion_icon">
			<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" width="1em" height="1em" fill="currentColor" focusable="false" class="a--icon" aria-hidden="true"><path d="M216.49,104.49l-80,80a12,12,0,0,1-17,0l-80-80a12,12,0,0,1,17-17L128,159l71.51-71.52a12,12,0,0,1,17,17Z"></path></svg>
		</span>
	</summary>
	<div class="d--accordion_body -my-s:15">
		<div class="d--accordion_inner">
			<p>Lorem ipsum...</p>
		</div>
	</div>
</details>
```
	</PreviewCode>
</Preview>


## 基本構造

<Preview>
	<PreviewCode slot='tab' label='HTML'>
		```pug
		details.d--accordion
			summary.d--accordion_header
				span.d--accordion_label Accordion Label
				span.d--accordion_icon
					svg.a--icon
			div.d--accordion_body
				div.d--accordion_inner(.l--flow) ...Contents...
		```
	</PreviewCode>
	<PreviewCode slot='tab' label='JSX'>
		```jsx
		<Accordion.Root>
			<Accordion.Header>
				<Accordion.Label>Accordion Label</Accordion.Label>
				<Accordion.Icon/>
			</Accordion.Header>
			<Accordion.Body>
				...Contents...
			</Accordion.Body>
		</Accordion.Root>
		```
	</PreviewCode>
</Preview>



## ソースコード

<Preview>
	<PreviewCode slot='tab' label='CSS'>
		<SrcCode dir='lism-ui' path='src/components/Accordion/_style.css' title='_style.css'/>
	</PreviewCode>
	<PreviewCode slot='tab' label='JS'>
		<SrcCode dir='lism-ui' path='src/components/Accordion/setAccordion.js' title='setAccordion.js'/>
	</PreviewCode>
	<PreviewCode slot='tab' label='React'>
		<SrcCode dir='lism-ui' path='src/components/Accordion/react/Accordion.jsx' title='Accordion.jsx'/>
	</PreviewCode>
</Preview>



## Import

`@lism-css/ui` パッケージで提供しています。

<ImportPackage component='Accordion' script='accordion.js' packageName='@lism-css/ui' />

以下のコンポーネントが利用できます。
- `<Accordion.Root>`
- `<Accordion.Header>`
- `<Accordion.Label>`
- `<Accordion.Icon>`
- `<Accordion.Body>`

さらに、`.HeaderLabel` を使うと、`.Header`, `.Label`, `.Icon` をまとめて配置できるようになっています。

```jsx
<Accordion.HeaderLabel {...props}>Text</Accordion.HeaderLabel>

↓ これは以下のように内部で展開されます

<Accordion.Header {...props}>
	<Accordion.Label>Text</Accordion.Label>
	<Accordion.Icon/>
</Accordion.Header>
```


## Props

| プロパティ | 説明 | 
|---|---|
| <PropBadge>`<Accordion.Icon>`</PropBadge><br/>`icon` | 内部で呼び出される`<Icon>` に渡す `icon` を指定できます。ただし、`<Accordion.Icon>`に子要素が配置されている場合は無視されます。 |
| <PropBadge>`<Accordion.Icon>`</PropBadge><br/>`isTrigger` | アイコンが `button`タグでの出力となり`[data-role="trigger"]`が付与されます。|
| <PropBadge>`<Accordion.Body>`</PropBadge><br/>`flow` | `__inner`に渡されます。 |
{/* <PropBadge type="attr">`data-role="trigger"`</PropBadge> */}


## Examples

### ラベルのHTMLタグとアイコンを変更する

ラベルをh3タグに、アイコンを x に変える例を紹介します。

<Preview>
	<PreviewTitle>例</PreviewTitle>
	<PreviewArea p='20'>
		<Stack bd-y>
			<Accordion.Root>
				<Accordion.Header p="15">
					<Accordion.Label tag='h3' f='inherit' fw='bold'>Accordion Label</Accordion.Label>
					<Accordion.Icon>
						<Icon viewBox="0 0 256 256" style={{transform: 'var(--_isOpen, rotate(45deg))'}}>
							<path d="M228,128a12,12,0,0,1-12,12H140v76a12,12,0,0,1-24,0V140H40a12,12,0,0,1,0-24h76V40a12,12,0,0,1,24,0v76h76A12,12,0,0,1,228,128Z"></path>
						</Icon>
					</Accordion.Icon>
				</Accordion.Header>
				<Accordion.Body p='15' py-s='5'>
					<Dummy length='l' />
				</Accordion.Body>
			</Accordion.Root>
			<Accordion.Root bd-t>
				<Accordion.Header p="15">
					<Accordion.Label tag='h3' f='inherit' fw='bold'>Accordion Label</Accordion.Label>
					<Accordion.Icon>
						<Icon viewBox="0 0 256 256" style={{transform: 'var(--_isOpen, rotate(45deg))'}}>
							<path d="M228,128a12,12,0,0,1-12,12H140v76a12,12,0,0,1-24,0V140H40a12,12,0,0,1,0-24h76V40a12,12,0,0,1,24,0v76h76A12,12,0,0,1,228,128Z"></path>
						</Icon>
					</Accordion.Icon>
				</Accordion.Header>
				<Accordion.Body p='15' py-s='5'>
					<Dummy length='l' />
				</Accordion.Body>
			</Accordion.Root>
		</Stack>
	</PreviewArea>
	<PreviewCode slot='tab' label='JSX'>
		```jsx
		<Stack bd-y>
			<Accordion.Root>
				<Accordion.Header p="15">
					<Accordion.Label tag='h3' f='inherit' fw='bold'>Accordion Label</Accordion.Label>
					<Accordion.Icon>
						<Icon viewBox="0 0 256 256" style={{transform: 'var(--_isOpen, rotate(45deg))'}}>
							<path d="M228,128a12,12,0,0,1-12,12H140v76a12,12,0,0,1-24,0V140H40a12,12,0,0,1,0-24h76V40a12,12,0,0,1,24,0v76h76A12,12,0,0,1,228,128Z"></path>
						</Icon>
					</Accordion.Icon>
				</Accordion.Header>
				<Accordion.Body p='15' py-s='5'>
					<Dummy length='l' />
				</Accordion.Body>
			</Accordion.Root>
			<Accordion.Root bd-t>
				<Accordion.Header p="15">
					<Accordion.Label tag='h3' f='inherit' fw='bold'>Accordion Label</Accordion.Label>
					<Accordion.Icon>
						<Icon viewBox="0 0 256 256" style={{transform: 'var(--_isOpen, rotate(45deg))'}}>
							<path d="M228,128a12,12,0,0,1-12,12H140v76a12,12,0,0,1-24,0V140H40a12,12,0,0,1,0-24h76V40a12,12,0,0,1,24,0v76h76A12,12,0,0,1,228,128Z"></path>
						</Icon>
					</Accordion.Icon>
				</Accordion.Header>
				<Accordion.Body p='15' py-s='5'>
					<Dummy length='l' />
				</Accordion.Body>
			</Accordion.Root>
		</Stack>
		```
	</PreviewCode>
	<PreviewCode slot='tab' label='HTML'>
	```html "h3" "-f:i"
	<details class="d--accordion -p:15">
		<summary class="d--accordion_header">
			<h3 class="d--accordion_label -f:i -fw:bold">Accordion Label</h3>
			...
	```
	</PreviewCode>
</Preview>

:::warning
summary 内の hタグは、スクリーンリーダーで読み上げる際に見出しとして認識されないという問題があります。
:::


### アニメーション時間を変更し、アコーディオンの複数同時展開を禁止する

アコーディオンの開閉アニメーションの時間は`--acc-duration`で管理できるようになっており、親要素に変数をセットすると、複数のアコーディオンに対して一括管理できます。

:::note
`:root`の`--acc-duration`を上書きすると、サイト全体でデフォルトの開閉速度を変更できます。
:::


また、複数の`<Accordion.Root>`(`.d--accordion`)を含む親要素に `[data-multiple="disallow"]`を指定することで、アコーディオンを複数同時に開くことを禁止することが可能です。


<Preview>
	<PreviewTitle>Preview</PreviewTitle>
	<PreviewArea p='20'>
		<Stack g='1px' data-multiple='disallow' style={{'--acc-duration': '.2s'}}>
			<Accordion.Root>
				<Accordion.HeaderLabel p='20' bgc='text' c='base' hov="neutral">Accordion Label</Accordion.HeaderLabel>
				<Accordion.Body p='20'>
					<Dummy length='l' />
				</Accordion.Body>
			</Accordion.Root>
			<Accordion.Root>
				<Accordion.HeaderLabel p='20' bgc='text' c='base' hov="neutral">Accordion Label</Accordion.HeaderLabel>
				<Accordion.Body p='20'>
					<Dummy length='xl' />
				</Accordion.Body>
			</Accordion.Root>
			<Accordion.Root>
				<Accordion.HeaderLabel p='20' bgc='text' c='base' hov="neutral">Accordion Label</Accordion.HeaderLabel>
				<Accordion.Body p='20'>
					<Dummy length='l' />
				</Accordion.Body>
			</Accordion.Root>
		</Stack>
	</PreviewArea>
	<PreviewCode slot='tab' label='JSX'>
```jsx "data-multiple='disallow'" "--acc-duration"
<Stack g='1px' data-multiple='disallow' style={{'--acc-duration': '.2s'}}>
	<Accordion.Root>
		<Accordion.HeaderLabel p='20' bgc='text' c='base' hov="neutral">Accordion Label</Accordion.HeaderLabel>
		<Accordion.Body p='20'>
			<Dummy length='l' />
		</Accordion.Body>
	</Accordion.Root>
	<Accordion.Root>
		<Accordion.HeaderLabel p='20' bgc='text' c='base' hov="neutral">Accordion Label</Accordion.HeaderLabel>
		<Accordion.Body p='20'>
			<Dummy length='xl' />
		</Accordion.Body>
	</Accordion.Root>
	<Accordion.Root>
		<Accordion.HeaderLabel p='20' bgc='text' c='base' hov="neutral">Accordion Label</Accordion.HeaderLabel>
		<Accordion.Body p='20'>
			<Dummy length='l' />
		</Accordion.Body>
	</Accordion.Root>
	...
</Stack>
```
	</PreviewCode>
	<PreviewCode slot='tab' label='HTML'>
```html "data-multiple=\"disallow\""
<div class="l--stack" data-multiple="disallow" style="--acc-duration: .2s">
	<details class="d--accordion">...</details>
	<details class="d--accordion">...</details>
	<details class="d--accordion">...</details>
</div>
```
	</PreviewCode>
</Preview>




## Opt-in 機能

追加でCSSが必要な機能


### 開閉時にアイコンを切り替える方法

追加で少しCSSを加える必要がありますが、開閉時にアイコンを切り替える例も紹介します。

<Preview css={`
.d--accordion_icon {
	> .a--icon {
		grid-area: 1 / 1;
		transform: var(--_isOpen, rotate(-180deg));
	}
	> .a--icon:nth-last-of-type(2) {
		opacity: var(--_isOpen, 0);
	}
	> .a--icon:nth-of-type(2) {
		opacity: var(--_notOpen, 0);
	}
}`}>
	<PreviewTitle>Example</PreviewTitle>
	<PreviewArea p='20'>
		<Stack g='15'>
			<Accordion.Root bgc='base' bxsh='10' bdrs='10' ov='hidden'>
				<Accordion.Header p='20' bgc='base-2' hov='neutral'>
					<Accordion.Label>Accordion Label</Accordion.Label>
					<Accordion.Icon>
						<Icon setTransition ga='1/1' viewBox="0 0 256 256">
							<path d="M228,128a12,12,0,0,1-12,12H140v76a12,12,0,0,1-24,0V140H40a12,12,0,0,1,0-24h76V40a12,12,0,0,1,24,0v76h76A12,12,0,0,1,228,128Z"></path>
						</Icon>
						<Icon setTransition ga='1/1' viewBox="0 0 256 256">
							<path d="M228,128a12,12,0,0,1-12,12H40a12,12,0,0,1,0-24H216A12,12,0,0,1,228,128Z"></path>
						</Icon>
					</Accordion.Icon>
				</Accordion.Header>
				<Accordion.Body p='20'>
					<Dummy length='l' />
				</Accordion.Body>
			</Accordion.Root>
			<Accordion.Root bgc='base' bxsh='10' bdrs='10' ov='hidden'>
				<Accordion.Header p='20' bgc='base-2' hov='neutral'>
					<Accordion.Label>Accordion Label</Accordion.Label>
					<Accordion.Icon>
						<Icon setTransition ga='1/1' viewBox="0 0 256 256">
							<path d="M228,128a12,12,0,0,1-12,12H140v76a12,12,0,0,1-24,0V140H40a12,12,0,0,1,0-24h76V40a12,12,0,0,1,24,0v76h76A12,12,0,0,1,228,128Z"></path>
						</Icon>
						<Icon setTransition ga='1/1' viewBox="0 0 256 256">
							<path d="M228,128a12,12,0,0,1-12,12H40a12,12,0,0,1,0-24H216A12,12,0,0,1,228,128Z"></path>
						</Icon>
					</Accordion.Icon>
				</Accordion.Header>
				<Accordion.Body p='20'>
					<Dummy length='l' />
				</Accordion.Body>
			</Accordion.Root>
		</Stack>
	</PreviewArea>
	<PreviewCode slot='tab' label='JSX'>
		```jsx
		<Stack g='15'>
			<Accordion.Root bgc='base' bxsh='10' bdrs='10' ov='hidden'>
				<Accordion.Header p='20' bgc='base-2' hov='neutral'>
					<Accordion.Label>Accordion Label</Accordion.Label>
					<Accordion.Icon>
						<Icon setTransition ga='1/1' viewBox="0 0 256 256">
							<path d="M228,128a12,12,0,0,1-12,12H140v76a12,12,0,0,1-24,0V140H40a12,12,0,0,1,0-24h76V40a12,12,0,0,1,24,0v76h76A12,12,0,0,1,228,128Z"></path>
						</Icon>
						<Icon setTransition ga='1/1' viewBox="0 0 256 256">
							<path d="M228,128a12,12,0,0,1-12,12H40a12,12,0,0,1,0-24H216A12,12,0,0,1,228,128Z"></path>
						</Icon>
					</Accordion.Icon>
				</Accordion.Header>
				<Accordion.Body p='20'>
					<Dummy length='l' />
				</Accordion.Body>
			</Accordion.Root>
			<Accordion.Root bgc='base' bxsh='10' bdrs='10' ov='hidden'>
				<Accordion.Header p='20' bgc='base-2' hov='neutral'>
					<Accordion.Label>Accordion Label</Accordion.Label>
					<Accordion.Icon>
						<Icon setTransition ga='1/1' viewBox="0 0 256 256">
							<path d="M228,128a12,12,0,0,1-12,12H140v76a12,12,0,0,1-24,0V140H40a12,12,0,0,1,0-24h76V40a12,12,0,0,1,24,0v76h76A12,12,0,0,1,228,128Z"></path>
						</Icon>
						<Icon setTransition ga='1/1' viewBox="0 0 256 256">
							<path d="M228,128a12,12,0,0,1-12,12H40a12,12,0,0,1,0-24H216A12,12,0,0,1,228,128Z"></path>
						</Icon>
					</Accordion.Icon>
				</Accordion.Header>
				<Accordion.Body p='20'>
					<Dummy length='l' />
				</Accordion.Body>
			</Accordion.Root>
		</Stack>
		```
	</PreviewCode>

	<PreviewCode slot='tab' label='**追加CSS**'>
		```css
		.d--accordion_icon {
			> .a--icon {
				transform: var(--_isOpen, rotate(-180deg));
			}
			> .a--icon:nth-last-of-type(2) {
				opacity: var(--_isOpen, 0);
			}
			> .a--icon:nth-of-type(2) {
				opacity: var(--_notOpen, 0);
			}
		}
		```
	</PreviewCode>
</Preview>


{/* ### アコーディオントリガーをアイコンのみにする

`<Accordion.Icon>` に `isTrigger` を指定すると、`button`タグでの出力となり`[data-role="trigger"]`が付与されます。  
この時、アコーディオンを開閉するための`click`イベントは `summary`（アコーディオンヘッダー）全体ではなくアイコン部分に対して登録されます。

:::check
これにより、**アコーディオンヘッダー内部のテキストリンクをクリックできる**ようになります。
:::

<Preview>
	<PreviewTitle>Preview</PreviewTitle>
	<PreviewArea p='15'>
		<Accordion.Root p='15'>
			<Accordion.Header trigger='icon'>
				<Accordion.Label><a href="#acc-innerlink">メニューリンク</a></Accordion.Label>
				<Accordion.Icon isTrigger bd bdrs='5' bgc='inherit' p='10' />
			</Accordion.Header>
			<Accordion.Body my-s='15'>
				<Dummy />
			</Accordion.Body>
		</Accordion.Root>
	</PreviewArea>
	<PreviewCode slot='tab' label='JSX'>
		```jsx "trigger='icon'"
		<Accordion.Root p='15'>
			<Accordion.Header trigger='icon'>
				<Accordion.Label><a href="#acc-innerlink">メニューリンク</a></Accordion.Label>
				<Accordion.Icon isTrigger bd bdrs='5' bgc='inherit' p='10' />
			</Accordion.Header>
			<Accordion.Body my-s='15'>...</Accordion.Body>
		</Accordion.Root>
		```
	</PreviewCode>
	<PreviewCode slot='tab' label='HTML'>
```html "<button" "data-role=\"trigger\""
<details class="d--accordion -p:15">
	<summary class="d--accordion_header">
		<span class="d--accordion_label">Labelテキスト（<a href="#acc-innerlink">ヘルプリンク</a></span>
		<button class="d--accordion_icon -d:ig -bd -bdrs:5 -bgc:inherit -p:10" data-role="trigger">
			<svg class="a--icon"...>...</svg>
		</button>
	</summary>
	<div class="d--accordion_body -my-s:15">
		<div class="d--accordion_inner">...</div>
	</div>
</details>
```
	</PreviewCode>
	<PreviewCode slot='tab' label='追加CSS'>
		```css
		.d--accordion_header:has(> [data-role='trigger']) {
			pointer-events: none;
		}

		.d--accordion_label > a,
		.d--accordion_icon {
			pointer-events: auto;
		}
		```
	</PreviewCode>
</Preview>

上記の追加CSSを適用することで、アイコン部分だけをクリックできるように制限することもできます。

<HelpText icon='info'>上記の追加CSSを適用しても、Tabキーでのカーソル操作時における`summary`タグ全体の選択を回避することはできません。</HelpText>
 */}


{/* ## スクリプトの処理の内容について

おおまかな処理ステップは以下の通りです。

- `d--accordion` の`summary`要素、または（`data-role="trigger"`があればその要素）に対してクリックイベント・トグルイベントを登録
- クリック時、開閉状態に応じて、open属性と`data-opened`属性を操作。
    - アニメーションの終了を待ってから状態を確定する。
	- アコーディオンが開く時、親要素に`data-multiple="disallow"` があるかチェックし、あれば他の兄弟要素を閉じる。
- トグル時の処理
    - open属性と`data-opened`属性が食い違った場合に修正。
- イベント解除(コンポーネントのアンマウント時に登録イベントを解除。) */}
