---
/**
 * トップページ（root言語用）
 * 最新の記事一覧を表示
 */
import BaseLayout from '../layouts/BaseLayout.astro';
import PostList from '@ui/PostList.astro';
import Pagination from '@ui/Pagination.astro';
import { HTML } from 'lism-css/astro';
import { siteConfig } from '@/config/site';
import { getPostsByLang } from '@/lib/content';
import { getRootLang } from '@/lib/i18n';

// 現在の言語（root言語）
const currentLang = getRootLang();

// ページあたりの記事数
const POSTS_PER_PAGE = siteConfig.pagination.postsPerPage;

// 記事一覧を日付の降順で取得
const allPosts = (await getPostsByLang(currentLang)).sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());

// 総ページ数を計算
const totalPages = Math.ceil(allPosts.length / POSTS_PER_PAGE);

// 1ページ目の記事を取得
const posts = allPosts.slice(0, POSTS_PER_PAGE);
---

<BaseLayout isTop title={siteConfig.name} lang={currentLang}>
	<HTML.h lv="1">Recent Posts</HTML.h>

	{/* 記事カードグリッド */}
	<PostList posts={posts} lang={currentLang} />

	{/* ページネーション */}
	<Pagination currentPage={1} totalPages={totalPages} lang={currentLang} />
</BaseLayout>
